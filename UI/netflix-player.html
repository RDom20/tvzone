<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Netflix-style Video Player (Local File)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background-color: rgb(20,20,20); color: white; }

    .video-container { 
      position: relative; 
      width: 100%; 
      height: 100vh; 
      overflow: hidden; 
    }
    .video-container.embedded { 
      height: 100%; 
    }
    .preview-container { 
      position: relative; 
      width: 100%; 
      height: 60vh; 
      overflow: hidden; 
    }
    .preview-container.embedded {
      height: 100%;
    }
    .preview-video { 
      width: 100%; 
      height: 100%; 
      object-fit: cover; 
    }

    .fullscreen-video {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 1000; background: black;
      display: none; flex-direction: column; justify-content: center; align-items: center;
    }
    .fullscreen-video video { width: 100%; height: 100%; object-fit: contain; background: black; }

    .content-info {
      padding: 20px;
      background: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgb(20,20,20) 100%);
      position: relative;
      margin-top: -100px;
    }

    .buttons { margin: 20px 0; }
    .btn {
      background-color: rgba(255,255,255,0.1);
      border: none; color: white;
      padding: 10px 20px; margin-right: 10px;
      cursor: pointer; border-radius: 4px; transition: all 0.3s ease;
    }
    .btn:hover { background-color: rgba(255,255,255,0.2); }
    .btn.play { background-color: white; color: black; }
    .btn.play:hover { background-color: rgba(255,255,255,0.8); }

    .reaction-btn {
      background: rgba(255,255,255,0.1);
      border: none;
      color: white;
      padding: 10px;
      border-radius: 50%;
      cursor: pointer;
      margin-right: 10px;
      transition: all 0.3s;
    }
    .reaction-btn:hover { background: rgba(255,255,255,0.2); }

    .details { margin-top: 20px; }
    .title { font-size: 2em; margin-bottom: 10px; }
    .description { color: #999; line-height: 1.5; }

    .video-controls {
      position: absolute; bottom: 0; left: 0; right: 0;
      background: rgba(0,0,0,0.7);
      padding: 10px; display: flex; align-items: center;
      justify-content: space-between; gap: 10px;
      z-index: 3000;
    }
    .control-group { display: flex; align-items: center; gap: 10px; }
    .control-btn {
      background: none; border: none; color: white; font-size: 18px; cursor: pointer; transition: opacity 0.2s ease;
    }
    .control-btn:hover { opacity: 0.7; }
    input[type="range"] { width: 100px; }

    .progress-bar {
      flex-grow: 1; height: 4px; background: rgba(255,255,255,0.3);
      border-radius: 2px; cursor: pointer; position: relative;
    }
    .progress { height: 100%; background: #007bff; width: 10%; }

    .time-tooltip {
      position: absolute; bottom: 20px; transform: translateX(-50%);
      background: rgba(0,0,0,0.75); color: white; padding: 3px 6px;
      border-radius: 4px; font-size: 12px; pointer-events: none; display: none;
    }
    #currentTime, #remainingTime { font-size: 14px; color: #ccc; padding: 0 5px; }

    /* Overlay: sebess√©g, mindig legfel√ºl */
    .overlay {
      position: absolute; bottom: 80px; right: 20px;
      background: rgba(0,0,0,0.85); color: white;
      padding: 20px; border-radius: 10px;
      display: flex; flex-direction: column; align-items: center;
      z-index: 4000;
    }
    .overlay.hidden { display: none; }

    /* --- SPEED MENU GOMBOK --- */
.speed-menu button, .speed-btn {
  background: #222;
  color: #fff;
  border: 1px solid #444;
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 14px;
  margin: 3px 0;
  transition: background 0.2s;
}
.speed-menu button:hover, .speed-btn:hover { background: #007bff; border-color: #007bff; }
.speed-menu button.active { background: #007bff; border-color: #007bff; }

#speedLabel {
  width: 50px;
  text-align: center;
  margin: 0 10px;
  display: inline-block;
}

/* Men√ºk fullscreenben is mindig l√°tszanak */
.res-menu, .cc-menu {
  position: absolute;
  bottom: 60px;
  background: rgba(30,30,30,0.95);
  padding: 10px;
  border-radius: 6px;
  display: none;
  flex-direction: column;
  gap: 5px;
  z-index: 4000;
}
.res-menu { right: 10px; }
.cc-menu { right: 70px; }

.res-menu button, .cc-menu button {
  background: #222;
  color: #fff;
  border: 1px solid #444;
  cursor: pointer;
  padding: 6px 12px;
  text-align: left;
  border-radius: 6px;
  transition: all 0.2s ease;
}
.res-menu button:hover, .cc-menu button:hover { background: #007bff; border-color: #007bff; }
.cc-menu button.active { background: #007bff; border-color: #007bff; }

.iframe-player {
  width: 100%;
  max-width: 1920px;
  aspect-ratio: 16 / 9;
  border: none;
  display: block;
  margin: auto;
  transform-origin: center center;
  transition: all 0.3s ease;
}


#scaledCanvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: black;
}

/* netflix-player.html -> <style> tag */

/* ... (Megl√©v≈ë st√≠lusok) ... */

/* üî• FELIRAT ST√çLUS BE√ÅLL√çT√ÅSA (alap√©rtelmezett Netflix-st√≠lus) */
#fullVideo::cue {
  font-family: Arial, sans-serif; /* Vagy a k√≠v√°nt font, pl. 'Netflix Sans', ha be van t√∂ltve */
  font-size: 18px; /* 12pt kb. 16px, de filmn√©l nagyobbat kell */
  background-color: rgba(0, 0, 0, 0.75); /* Fekete h√°tt√©r, √°tl√°tsz√≥an */
  color: white;
  padding: 5px 10px;
   border-radius: 4px;
  /* A poz√≠ci√≥t a b√∂ng√©sz≈ë kezeli (alul, k√∂z√©pen), ezt a ::cue teszi lehet≈ëv√© */
  text-shadow: 0 0 4px black; /* Egy kis √°rny√©k seg√≠t az olvashat√≥s√°gon */
}

  </style>
</head>
<body>

<iframe id="playerIframe" class="iframe-player"
  src="http://localhost:3000/netflix-player.html?embedded=true"
  allowfullscreen allow="autoplay; picture-in-picture"></iframe>

  <!-- FULLSCREEN PLAYER -->
  <div class="fullscreen-video" id="playerContainer">
  <video id="fullVideo" controlslist="nodownload">
    <source id="videoSource" src="data/Movies/Batman Begins.mp4" type="video/mp4" />
  </video>
  <canvas id="scaledCanvas"></canvas>


    <div class="video-controls">
      <div class="control-group left">
        <button class="control-btn" id="playPause"><i class="fas fa-play"></i></button>
        <input type="range" id="volume" min="0" max="1" step="0.05" value="1" />
        <span id="currentTime">0:00</span>
      </div>

      <div class="progress-bar" id="progressBar">
        <div class="progress" id="progress"></div>
      </div>

      <div class="control-group right">
        
        <span id="remainingTime">-0:00 / 1.00x</span>
        <button class="control-btn" onclick="toggleSpeed()"><i class="fas fa-tachometer-alt"></i></button>
        <button class="control-btn" onclick="toggleCC()"><i class="fas fa-closed-captioning"></i></button>
        <button class="control-btn" onclick="toggleQuality()"><i class="fas fa-cog"></i></button>
        <button class="control-btn fullscreen-open" onclick="toggleFullscreen()"><i class="fa-solid fa-expand"></i></button>
        <button class="control-btn fullscreen-close" style="display:none;" onclick="toggleFullscreen()"><i class="fa-solid fa-compress"></i></button>
      </div>

      <div id="resMenu" class="res-menu">
        <button onclick="setResolution('1080p')">1080p</button>
        <button onclick="setResolution('720p')">720p</button>
        <button onclick="setResolution('480p')">480p</button>
        <button onclick="setResolution('360p')">360p</button>
      </div>

      <div id="ccMenu" class="cc-menu" style="display: flex;">
  <button onclick="setSubtitle('off')">Off</button>
  <button onclick="setSubtitle('eng')">English</button>
  <button onclick="setSubtitle('hun')">Hungarian</button>
</div>


      <div id="speedOverlay" class="overlay hidden">
        <div class="speed-box">
          <div>
            <button class="speed-btn" onclick="adjustSpeed(-0.25)">‚àí</button>
            <span id="speedLabel">1.00x</span>
            <button class="speed-btn" onclick="adjustSpeed(0.25)">+</button>
          </div>
          <input type="range" id="speedSlider" min="0.25" max="3" step="0.01" value="1" />

          <div style="margin-top:10px; display:flex; flex-direction: column; gap:5px;">
            <button class="speed-btn" data-speed="0.25">0.25x</button>
            <button class="speed-btn" data-speed="0.5">0.5x</button>
            <button class="speed-btn" data-speed="0.75">0.75x</button>
            <button class="speed-btn" data-speed="1">1x</button>
            <button class="speed-btn" data-speed="1.25">1.25x</button>
            <button class="speed-btn" data-speed="1.5">1.5x</button>
            <button class="speed-btn" data-speed="1.75">1.75x</button>
            <button class="speed-btn" data-speed="2">2x</button>
            <button class="speed-btn" data-speed="2.5">2.5x</button>
            <button class="speed-btn" data-speed="3">3x</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>

  const video = document.getElementById('fullVideo');
  const canvas = document.getElementById('scaledCanvas');
  const ctx = canvas.getContext('2d');
  const playPauseBtn = document.getElementById('playPause');
  const volumeSlider = document.getElementById('volume');
  const progressBar = document.getElementById('progressBar');
  const progress = document.getElementById('progress');
  const currentTimeDisplay = document.getElementById('currentTime');
  const remainingTimeDisplay = document.getElementById('remainingTime');
  const speedOverlay = document.getElementById('speedOverlay');
  const speedLabel = document.getElementById('speedLabel');
  const speedSlider = document.getElementById('speedSlider');
  const resMenu = document.getElementById('resMenu');
  const ccMenu = document.getElementById('ccMenu');
  const fullscreenContainer = document.getElementById('playerContainer');

  let scaleFactor = 1.0;
let smoothingLevel = 'high';
let animationFrameId = null;

  document.addEventListener("DOMContentLoaded", () => {
  const video = document.getElementById("fullVideo");
  if (!video) {
    console.error("‚ùå Nincs #fullVideo!");
    return;
  }
  // itt j√∂het a t√∂bbi k√≥d
});

  
  function playFullscreen() {
    fullscreenContainer.style.display = 'flex';
    fullVideo.play();
    fullVideo.volume = 1; 
    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
  }

  playPauseBtn.addEventListener('click', () => {
    if (fullVideo.paused) {
      fullVideo.play();
      playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
    } else {
      fullVideo.pause();
      playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
    }
  });

  volumeSlider.addEventListener('input', () => {
    fullVideo.volume = volumeSlider.value;
  });

  fullVideo.addEventListener('timeupdate', () => {
      if (!fullVideo.duration || isNaN(fullVideo.duration)) return;
    const progressPercent = (fullVideo.currentTime / fullVideo.duration) * 100;
    progress.style.width = progressPercent + '%';

    const minutes = Math.floor(fullVideo.currentTime / 60);
    const seconds = Math.floor(fullVideo.currentTime % 60);
    currentTimeDisplay.textContent = minutes + ':' + (seconds < 10 ? '0' + seconds : seconds);

    // Marad√©k id≈ë kisz√°m√≠t√°sa ‚Äî a sebess√©g figyelembev√©tel√©vel
const remainingReal = (fullVideo.duration - fullVideo.currentTime) / fullVideo.playbackRate;
const rMinutes = Math.floor(remainingReal / 60);
const rSeconds = Math.floor(remainingReal % 60);

remainingTimeDisplay.textContent =
  `-${rMinutes}:${rSeconds < 10 ? '0' + rSeconds : rSeconds} / ${fullVideo.playbackRate.toFixed(2)}x`;
  });

  progressBar.addEventListener('click', e => {
    const rect = progressBar.getBoundingClientRect();
    const pos = (e.clientX - rect.left) / rect.width;
    fullVideo.currentTime = pos * fullVideo.duration;
  });

  /* Speed menu */
  function toggleSpeed() {
    const isHidden = speedOverlay.classList.contains('hidden');
    speedOverlay.classList.toggle('hidden');
  }

  function adjustSpeed(amount) {
    let newSpeed = fullVideo.playbackRate + amount;
    if(newSpeed < 0.25) newSpeed = 0.25;
    if(newSpeed > 3) newSpeed = 3;
    fullVideo.playbackRate = newSpeed;
    speedSlider.value = newSpeed;
    speedLabel.textContent = newSpeed.toFixed(2) + 'x';
  }

  speedSlider.addEventListener('input', () => {
    fullVideo.playbackRate = parseFloat(speedSlider.value);
    speedLabel.textContent = speedSlider.value + 'x';
  });

  document.querySelectorAll('.speed-btn[data-speed]').forEach(btn => {
    btn.addEventListener('click', () => {
      const val = parseFloat(btn.dataset.speed);
      fullVideo.playbackRate = val;
      speedSlider.value = val;
      speedLabel.textContent = val.toFixed(2) + 'x';
    });
  });

  // In netflix-player.html <script>
// ... (all your existing code)

// In netflix-player.html <script>
// ... (Your existing variables and functions)
let subtitles = {
    off: null,
    eng: null,
    hun: null
  };
  let currentSubtitle = 'off'; // Ensure this is defined

// ---------------------------------------------------------
// Subtitle control functions
// ---------------------------------------------------------
function setSubtitle(lang) {
  const video = document.getElementById("fullVideo");

  // teszt √ºzenet
  if (lang === "eng") {
    alert("English subtitle button clicked!");
  } else if (lang === "hun") {
    alert("Hungarian subtitle button clicked!");
  } else {
    alert("Subtitles turned off!");
  }

  // t√∂r√∂lj√ºk a megl√©v≈ë track-eket
  video.querySelectorAll("track").forEach(t => t.remove());

  if (lang === "off") return;

  // URL-b≈ël vessz√ºk a feliratokat
  let subtitleFile = "";
  if (lang === "eng") {
    subtitleFile = getQueryParam("srt");
  } else if (lang === "hun") {
    subtitleFile = getQueryParam("srt_hu");
  }

  if (!subtitleFile) {
    console.warn("‚ùå Nincs felirat URL ehhez:", lang);
    return;
  }

  const track = document.createElement("track");
  track.kind = "subtitles";
  track.label = lang === "eng" ? "English" : "Hungarian";
  track.srclang = lang;
  track.src = decodeURIComponent(subtitleFile);
  track.default = true;

  video.appendChild(track);

  // aktiv√°ljuk a hozz√°adott tracket
  for (let t of video.textTracks) {
    t.mode = t.label.toLowerCase() === track.label.toLowerCase() ? "showing" : "disabled";
  }
}



// ... (Continue with your other functions)


  

  // A mappa helye ‚Äì abszol√∫t el√©r√©si √∫t
const MOVIE_PATH = "C:\\Users\\rdomi\\OneDrive - Ny√≠regyh√°zi Egyetem (Student)\\TVZone\\data\\Movies\\";

document.querySelectorAll('.carousel-item').forEach(item => {
  item.addEventListener('click', () => {
    // A film c√≠m√©t az elem <h3>-j√©b≈ël olvassuk ki
    const movieTitle = item.querySelector('h3').innerText.trim();

    // El√©r√©si utak (a f√°jlnevek egyezzenek a c√≠mekkel)
    const videoPath = `${MOVIE_PATH}${movieTitle}.mp4`;
    const engSub = `${MOVIE_PATH}Subtitles\\${movieTitle} Eng.srt`;
    const hunSub = `${MOVIE_PATH}Subtitles\\${movieTitle} Hun.srt`;

    // Bet√∂ltj√ºk a vide√≥t
    loadMovie(movieTitle, videoPath, engSub, hunSub);
  });
});

function loadMovie(title, videoPath, engSub, hunSub) {
  const video = document.getElementById('fullVideo');
  const source = document.getElementById('videoSource');

  // Vide√≥ bet√∂lt√©se
  source.src = videoPath;
  video.load();

  // Feliratok t√∂rl√©se √©s √∫j hozz√°ad√°sa
  while (video.firstChild) {
    if (video.firstChild.tagName === 'TRACK') video.removeChild(video.firstChild);
    else break;
  }

  // Angol felirat
  const trackEng = document.createElement('track');
  trackEng.kind = 'subtitles';
  trackEng.label = 'English';
  trackEng.srclang = 'en';
  trackEng.src = engSub;
  video.appendChild(trackEng);

  // Magyar felirat
  const trackHun = document.createElement('track');
  trackHun.kind = 'subtitles';
  trackHun.label = 'Hungarian';
  trackHun.srclang = 'hu';
  trackHun.src = hunSub;
  video.appendChild(trackHun);

  // Film elind√≠t√°sa
  document.getElementById('playerContainer').style.display = 'flex';
  video.play();
}

  function toggleCC() {
    // Cycle through the subtitles: off, eng, hun
    if (currentSubtitle === 'off') {
      currentSubtitle = 'eng';
    } else if (currentSubtitle === 'eng') {
      currentSubtitle = 'hun';
    } else {
      currentSubtitle = 'off';
    }

    // Enable/Disable the appropriate subtitle
    for (let track of fullVideo.textTracks) {
      track.mode = track.label.toLowerCase() === currentSubtitle ? 'showing' : 'disabled';
    }
  }


  function toggleQuality() { 
    const isHidden = speedOverlay.classList.contains('hidden');
    resMenu.style.display = resMenu.style.display === 'flex' ? 'none' : 'flex';
  }

  const iframe = document.getElementById('playerIframe');

function setIframeResolution(res) {
  let width, height, scale;
  switch (res) {
    case '360p':
      width = 640; height = 360; scale = 1920 / 640;
      break;
    case '480p':
      width = 854; height = 480; scale = 1920 / 854;
      break;
    case '720p':
      width = 1280; height = 720; scale = 1920 / 1280;
      break;
    case '1080p':
    default:
      width = 1920; height = 1080; scale = 1;
  }

  // IFrame m√©ret be√°ll√≠t√°sa
  iframe.style.width = `${width}px`;
  iframe.style.height = `${height}px`;

  // Felsk√°l√°z√°s, hogy mindig teljes m√©retben l√°tsz√≥djon
  iframe.style.transform = `scale(${scale})`;

  console.log(`üñ• IFrame resolution set to ${width}x${height} (scaled ${scale.toFixed(2)}x)`);

  // Jelezd az iframe-nek, hogy bel√ºl is √°ll√≠tson felbont√°st
  iframe.contentWindow.postMessage({ action: 'setResolution', resolution: res }, '*');
}



  function resizeCanvas() {
  const w = video.videoWidth;
  const h = video.videoHeight;
  canvas.width = w;
  canvas.height = h;
}
video.addEventListener('loadedmetadata', resizeCanvas);

// Render loop ‚Äì folyamatosan rajzoljuk a vide√≥t a canvasra



video.addEventListener('play', () => {
  cancelAnimationFrame(animationFrameId);
  renderFrame();
});
video.addEventListener('pause', () => cancelAnimationFrame(animationFrameId));



function setResolution(res) {
  switch (res) {
    case '1080p':
      scaleFactor = 1.0;
      smoothingLevel = 'high';
      break;
    case '720p':
      scaleFactor = 0.66;
      smoothingLevel = 'medium';
      break;
    case '480p':
      scaleFactor = 0.44;
      smoothingLevel = 'low';
      break;
    case '360p':
      scaleFactor = 0.33;
      smoothingLevel = 'none';
      break;
    default:
      scaleFactor = 1.0;
      smoothingLevel = 'high';
  }

  // IFrame friss√≠t√©s (maradhat)
  if (typeof setIframeResolution === 'function') {
    setIframeResolution(res);
  }

  console.log(`üìâ Render resolution set: ${res} (${smoothingLevel})`);
}


function renderFrame() {
  if (!video.paused && !video.ended) {
    // --- Val√≥s "felbont√°s" pixelar√°ny a bitrate √©rt√©kek alapj√°n ---
    let targetWidth, targetHeight;
    switch (smoothingLevel) {
      case 'none':   // 360p
        targetWidth = 640;
        targetHeight = 360;
        break;
      case 'low':    // 480p
        targetWidth = 854;
        targetHeight = 480;
        break;
      case 'medium': // 720p
        targetWidth = 1280;
        targetHeight = 720;
        break;
      case 'high':   // 1080p
      default:
        targetWidth = 1920;
        targetHeight = 1080;
    }

    // --- offscreen canvas: kis felbont√°sban renderel√ºnk ---
    const offscreen = document.createElement('canvas');
    offscreen.width = targetWidth;
    offscreen.height = targetHeight;
    const offCtx = offscreen.getContext('2d');
    offCtx.imageSmoothingEnabled = true;
    offCtx.imageSmoothingQuality = 'high';

    // K√©p renderel√©se a vide√≥b√≥l
    offCtx.drawImage(video, 0, 0, targetWidth, targetHeight);

    // --- f≈ë canvas t√∂rl√©se √©s felsk√°l√°z√°s ---
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.imageSmoothingEnabled = false; // √≠gy blokkszer≈±bb marad
    ctx.drawImage(offscreen, 0, 0, canvas.width, canvas.height);

    // --- opcion√°lis enyhe blur a kisebbekhez ---
    if (smoothingLevel !== 'high') {
      ctx.filter = 'blur(0.2px)';
    } else {
      ctx.filter = 'none';
    }
  }

  animationFrameId = requestAnimationFrame(renderFrame);
}


video.addEventListener('play', () => {
  cancelAnimationFrame(animationFrameId);
  renderFrame();
});

video.addEventListener('pause', () => cancelAnimationFrame(animationFrameId));


  /* Fullscreen toggle */
  function toggleFullscreen() {
    if (!document.fullscreenElement) {
      fullscreenContainer.requestFullscreen();
    } else {
      document.exitFullscreen();
    }
  }

  /* --- BILLENTY≈∞PARANCSOK --- */
  document.addEventListener('keydown', (e) => {
    if (!fullscreenContainer.style.display.includes('flex')) return;

    switch (e.key.toLowerCase()) {
      case ' ':
        e.preventDefault();
        playPauseBtn.click();
        break;
      case 'f':
        toggleFullscreen();
        break;
      case 'c':
        toggleCC();
        break;
      case 'q':
        toggleQuality();
        break;
      case 'arrowleft':
      case 'a':
        fullVideo.currentTime = Math.max(0, fullVideo.currentTime - 5);
        break;
      case 'arrowright':
      case 'd':
        fullVideo.currentTime = Math.min(fullVideo.duration, fullVideo.currentTime + 5);
        break;
      case 'arrowup':
      case 'w':
        fullVideo.volume = Math.min(1, fullVideo.volume + 0.05);
        volumeSlider.value = fullVideo.volume;
        break;
      case 'arrowdown':
      case 's':
        fullVideo.volume = Math.max(0, fullVideo.volume - 0.05);
        volumeSlider.value = fullVideo.volume;
        break;
      case 'escape':
        if (document.fullscreenElement) document.exitFullscreen();
        break;
    }
  });

  document.addEventListener('click', (e) => {
  // Ha a kattint√°s nem a gombokban vagy a men√ºkben t√∂rt√©nt, z√°rjuk be ≈ëket.
  if (!e.target.closest('.control-btn') && 
      !e.target.closest('.res-menu') && 
      !e.target.closest('.cc-menu') && 
      !e.target.closest('.overlay')) {
    resMenu.style.display = 'none';
    ccMenu.style.display = 'none';
    speedOverlay.classList.add('hidden');
  }
});

// Gombok esem√©nykezel≈ëi
function toggleSpeed() {
  speedOverlay.classList.toggle('hidden');
  resMenu.style.display = 'none';  // Ha a sebess√©g men√º ny√≠lik, z√°rd le a t√∂bbit
  ccMenu.style.display = 'none';
}

function toggleCC() {
  ccMenu.style.display = ccMenu.style.display === 'none' ? 'flex' : 'none';
  resMenu.style.display = 'none';  // Ha a felirat men√º ny√≠lik, z√°rd le a t√∂bbit
  speedOverlay.classList.add('hidden');
}

function toggleQuality() { 
  resMenu.style.display = resMenu.style.display === 'none' ? 'flex' : 'none';
  ccMenu.style.display = 'none';  // Ha a felbont√°s men√º ny√≠lik, z√°rd le a t√∂bbit
  speedOverlay.classList.add('hidden');
}

fullVideo.addEventListener('play', () => {
  fullVideo.muted = false;  // T√∂rli a n√©m√≠t√°st.
});

volumeSlider.addEventListener('input', () => {
  fullVideo.volume = volumeSlider.value;
});

// Parse query parameters and auto-load video + subtitles when opening via URL
function getQueryParam(name) {
  const params = new URLSearchParams(window.location.search);
  return params.get(name);
}

document.addEventListener('DOMContentLoaded', () => {
  const src = getQueryParam('src');
  const srt = getQueryParam('srt');
  const srtHu = getQueryParam('srt_hu');
  const title = getQueryParam('title');
  if (src) {
    try {
      const sourceEl = document.getElementById('videoSource');
      const srcDecoded = decodeURIComponent(src);
      sourceEl.src = srcDecoded;
      if (srcDecoded.toLowerCase().endsWith('.mkv')) sourceEl.type = 'video/x-matroska';
      else sourceEl.type = 'video/mp4';

      // Remove any existing track elements then add subtitles if provided
      Array.from(fullVideo.querySelectorAll('track')).forEach(t => t.remove());
      if (srt) {
        const srtDecoded = decodeURIComponent(srt);
        const track = document.createElement('track');
        track.kind = 'subtitles';
        track.label = 'English';
        track.srclang = 'en';
        track.src = srtDecoded;
        track.default = true;
        fullVideo.appendChild(track);
      }
      if (srtHu) {
        const srtHuDecoded = decodeURIComponent(srtHu);
        const trackHu = document.createElement('track');
        trackHu.kind = 'subtitles';
        trackHu.label = 'Hungarian';
        trackHu.srclang = 'hu';
        trackHu.src = srtHuDecoded;
        fullVideo.appendChild(trackHu);
      }

      fullVideo.load();
fullscreenContainer.style.display = 'flex';
console.log("‚è∏ Vide√≥ bet√∂ltve, v√°rakoz√°s a PLAY gombra...");

    } catch (err) {
      console.error('Error loading video from query params', err);
    }
  }
  if (title) {
    const t = document.querySelector('.title');
    if (t) t.textContent = decodeURIComponent(title);
  }
});

// --- √ºzenet figyel√©se az iframe-en bel√ºl ---
window.addEventListener("message", (event) => {
  const video = document.getElementById("fullVideo");
  const playPauseBtn = document.getElementById("playPause");
  if (!video) return;

  console.log("üì© IFrame √ºzenet:", event.data);

  if (event.data.action === "play") {
    video.muted = false;
    video.play()
      .then(() => {
        console.log("üé¨ Vide√≥ lej√°tsz√°s elind√≠tva √ºzenetb≈ël");
        if (playPauseBtn) {
          playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
        }
      })
      .catch(err => console.error("Nem siker√ºlt elind√≠tani:", err));
  }
});

</script>
</body>
</html>


